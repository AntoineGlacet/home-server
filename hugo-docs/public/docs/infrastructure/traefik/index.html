<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Traefik - Reverse Proxy & TLS | Home Server Documentation</title><meta name=description content="Automatic HTTPS routing and Let's Encrypt certificate management"><meta property="og:url" content="https://docs.antoineglacet.com/docs/infrastructure/traefik/"><meta property="og:site_name" content="Home Server Documentation"><meta property="og:title" content="Traefik - Reverse Proxy & TLS"><meta property="og:description" content="Automatic HTTPS routing and Let's Encrypt certificate management"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="Traefik - Reverse Proxy & TLS"><meta itemprop=description content="Automatic HTTPS routing and Let's Encrypt certificate management"><meta itemprop=wordCount content="1309"><meta name=twitter:card content="summary"><meta name=twitter:title content="Traefik - Reverse Proxy & TLS"><meta name=twitter:description content="Automatic HTTPS routing and Let's Encrypt certificate management"><link rel=preload href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css as=style integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><link href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css rel=stylesheet integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Home Server Documentation</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class="nav-link active" href=/docs/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=https://homepage.antoineglacet.com target=_blank rel=noopener><span>Homepage</span></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-docsinfrastructuretraefik").addClass("active"),$("#td-section-nav #m-docsinfrastructuretraefik-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-docsinfrastructuretraefik").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-docsinfrastructuretraefik-li").siblings("li").addClass("show"),$("#td-section-nav #m-docsinfrastructuretraefik-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs-li><a href=/docs/ title=Documentation class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Docs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsoperations-li><input type=checkbox id=m-docsoperations-check>
<label for=m-docsoperations-check><a href=/docs/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsoperations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsoperating-li><input type=checkbox id=m-docsoperationsoperating-check>
<label for=m-docsoperationsoperating-check><a href=/docs/operations/operating/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsoperating><span>Operating Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsquick_start-li><input type=checkbox id=m-docsoperationsquick_start-check>
<label for=m-docsoperationsquick_start-check><a href=/docs/operations/quick_start/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsquick_start><span>Quick Start: Fix SSH Lag & LAN Latency</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance-tuning-li><input type=checkbox id=m-docsoperationsperformance-tuning-check>
<label for=m-docsoperationsperformance-tuning-check><a href=/docs/operations/performance-tuning/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance-tuning><span>Performance Tuning Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance_optimization-li><input type=checkbox id=m-docsoperationsperformance_optimization-check>
<label for=m-docsoperationsperformance_optimization-check><a href=/docs/operations/performance_optimization/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance_optimization><span>Performance Optimization Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsinfrastructure-li><input type=checkbox id=m-docsinfrastructure-check>
<label for=m-docsinfrastructure-check><a href=/docs/infrastructure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsinfrastructure><span>Infrastructure</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructuretraefik-li><input type=checkbox id=m-docsinfrastructuretraefik-check>
<label for=m-docsinfrastructuretraefik-check><a href=/docs/infrastructure/traefik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructuretraefik><span>Traefik - Reverse Proxy & TLS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructureauthentik-li><input type=checkbox id=m-docsinfrastructureauthentik-check>
<label for=m-docsinfrastructureauthentik-check><a href=/docs/infrastructure/authentik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructureauthentik><span>Authentik - SSO & Authentication</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsmonitoring-li><input type=checkbox id=m-docsmonitoring-check>
<label for=m-docsmonitoring-check><a href=/docs/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsmonitoring><span>Monitoring</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringmonitoring-li><input type=checkbox id=m-docsmonitoringmonitoring-check>
<label for=m-docsmonitoringmonitoring-check><a href=/docs/monitoring/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringmonitoring><span>Monitoring & Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringgrafana-setup-li><input type=checkbox id=m-docsmonitoringgrafana-setup-check>
<label for=m-docsmonitoringgrafana-setup-check><a href=/docs/monitoring/grafana-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringgrafana-setup><span>Grafana Setup Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docstroubleshooting-li><input type=checkbox id=m-docstroubleshooting-check>
<label for=m-docstroubleshooting-check><a href=/docs/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docstroubleshooting><span>Troubleshooting</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstroubleshootingtroubleshooting-li><input type=checkbox id=m-docstroubleshootingtroubleshooting-check>
<label for=m-docstroubleshootingtroubleshooting-check><a href=/docs/troubleshooting/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docstroubleshootingtroubleshooting><span>Troubleshooting Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdeployment-li><input type=checkbox id=m-docsdeployment-check>
<label for=m-docsdeployment-check><a href=/docs/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdeployment><span>Deployment</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_checklist-li><input type=checkbox id=m-docsdeploymentdeployment_checklist-check>
<label for=m-docsdeploymentdeployment_checklist-check><a href=/docs/deployment/deployment_checklist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_checklist><span>Deployment Checklist - Infrastructure Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentpost-commit-steps-li><input type=checkbox id=m-docsdeploymentpost-commit-steps-check>
<label for=m-docsdeploymentpost-commit-steps-check><a href=/docs/deployment/post-commit-steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentpost-commit-steps><span>Post-Commit Setup Steps</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_notes-li><input type=checkbox id=m-docsdeploymentdeployment_notes-check>
<label for=m-docsdeploymentdeployment_notes-check><a href=/docs/deployment/deployment_notes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_notes><span>Deployment Notes - 2026-01-16</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymenthugo-site-setup-li><input type=checkbox id=m-docsdeploymenthugo-site-setup-check>
<label for=m-docsdeploymenthugo-site-setup-check><a href=/docs/deployment/hugo-site-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymenthugo-site-setup><span>Hugo Documentation Site - Setup Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentalerting_migration-li><input type=checkbox id=m-docsdeploymentalerting_migration-check>
<label for=m-docsdeploymentalerting_migration-check><a href=/docs/deployment/alerting_migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentalerting_migration><span>Alerting Migration to Grafana</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentreadme-li><input type=checkbox id=m-docsdeploymentreadme-check>
<label for=m-docsdeploymentreadme-check><a href=/docs/deployment/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentreadme><span></span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsplanning-li><input type=checkbox id=m-docsplanning-check>
<label for=m-docsplanning-check><a href=/docs/planning/ title="Planning & Status" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsplanning><span>Planning</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningimplementation_status-li><input type=checkbox id=m-docsplanningimplementation_status-check>
<label for=m-docsplanningimplementation_status-check><a href=/docs/planning/implementation_status/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningimplementation_status><span>Implementation Status - Home Server Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningnext_steps-li><input type=checkbox id=m-docsplanningnext_steps-check>
<label for=m-docsplanningnext_steps-check><a href=/docs/planning/next_steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningnext_steps><span>Next Steps - Alerting Migration Testing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningsecurity_remediation-li><input type=checkbox id=m-docsplanningsecurity_remediation-check>
<label for=m-docsplanningsecurity_remediation-check><a href=/docs/planning/security_remediation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningsecurity_remediation><span>Security Remediation: Discord Webhook Leak</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningreadme-li><input type=checkbox id=m-docsplanningreadme-check>
<label for=m-docsplanningreadme-check><a href=/docs/planning/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningreadme><span></span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#overview>Overview</a><ul><li><a href=#key-features>Key Features</a></li><li><a href=#access-points>Access Points</a></li><li><a href=#architecture>Architecture</a></li></ul></li><li><a href=#how-it-works>How It Works</a><ul><li><a href=#entry-points>Entry Points</a></li><li><a href=#routers>Routers</a></li><li><a href=#services>Services</a></li><li><a href=#middlewares>Middlewares</a></li></ul></li><li><a href=#certificate-management>Certificate Management</a><ul><li><a href=#dns-01-challenge>DNS-01 Challenge</a></li><li><a href=#certificate-storage>Certificate Storage</a></li><li><a href=#certificate-dumper>Certificate Dumper</a></li><li><a href=#wildcard-certificate>Wildcard Certificate</a></li><li><a href=#certificate-renewal>Certificate Renewal</a></li></ul></li><li><a href=#exposing-services>Exposing Services</a><ul><li><a href=#basic-service-exposure>Basic Service Exposure</a></li><li><a href=#adding-authentication>Adding Authentication</a></li><li><a href=#host-network-services>Host Network Services</a></li><li><a href=#multiple-routers>Multiple Routers</a></li></ul></li><li><a href=#monitoring>Monitoring</a><ul><li><a href=#dashboard>Dashboard</a></li><li><a href=#prometheus-metrics>Prometheus Metrics</a></li><li><a href=#logs>Logs</a></li><li><a href=#health-check>Health Check</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#certificate-issues>Certificate Issues</a></li><li><a href=#routing-issues>Routing Issues</a></li><li><a href=#authentik-middleware-issues>Authentik Middleware Issues</a></li><li><a href=#performance-issues>Performance Issues</a></li><li><a href=#checking-configuration>Checking Configuration</a></li><li><a href=#common-mistakes>Common Mistakes</a></li><li><a href=#debugging-workflow>Debugging Workflow</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/infrastructure/>Infrastructure</a></li><li class="breadcrumb-item active" aria-current=page>Traefik - Reverse Proxy & TLS</li></ol></nav><div class=td-content><h1>Traefik - Reverse Proxy & TLS</h1><div class=lead>Automatic HTTPS routing and Let&rsquo;s Encrypt certificate management</div><header class=article-meta></header><p>Traefik automatically routes external HTTPS traffic to internal services and manages Let&rsquo;s Encrypt certificates.</p><h2 id=table-of-contents>Table of Contents</h2><ul><li><a href=#overview>Overview</a></li><li><a href=#how-it-works>How It Works</a></li><li><a href=#certificate-management>Certificate Management</a></li><li><a href=#exposing-services>Exposing Services</a></li><li><a href=#monitoring>Monitoring</a></li><li><a href=#troubleshooting>Troubleshooting</a></li></ul><h2 id=overview>Overview</h2><h3 id=key-features>Key Features</h3><ul><li><strong>Automatic HTTPS</strong>: All services get TLS certificates via Cloudflare DNS-01 challenge</li><li><strong>Wildcard certificate</strong>: Single cert covers <code>antoineglacet.com</code> and <code>*.antoineglacet.com</code></li><li><strong>Docker integration</strong>: Services auto-discovered via Docker labels</li><li><strong>Authentik integration</strong>: Forward auth middleware protects sensitive services</li><li><strong>Metrics export</strong>: Prometheus scrapes Traefik metrics on port 8082</li></ul><h3 id=access-points>Access Points</h3><ul><li><strong>Dashboard</strong>: <a href=https://traefik.antoineglacet.com>https://traefik.antoineglacet.com</a> (protected by Authentik)</li><li><strong>Metrics</strong>: http://localhost:8082/metrics (Prometheus endpoint)</li><li><strong>API</strong>: http://localhost:8080/api (if enabled)</li></ul><h3 id=architecture>Architecture</h3><pre tabindex=0><code>Internet → Port 443 → Traefik → Authentik (optional) → Service
                      ↓
                   Let&#39;s Encrypt (DNS-01 challenge via Cloudflare)
</code></pre><h2 id=how-it-works>How It Works</h2><h3 id=entry-points>Entry Points</h3><p>Traefik listens on two entry points:</p><ol><li><strong>web</strong> (port 80): HTTP traffic, redirects to HTTPS</li><li><strong>websecure</strong> (port 443): HTTPS traffic with TLS</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View entry points configuration</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik cat /etc/traefik/traefik.yml
</span></span></code></pre></div><h3 id=routers>Routers</h3><p>Routers match incoming requests and forward to services.</p><p>Defined via Docker labels:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.SERVICE_NAME.rule=Host(`service.antoineglacet.com`)&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.SERVICE_NAME.entrypoints=websecure&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.SERVICE_NAME.tls.certresolver=cloudflare&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>View active routers:</strong></p><ul><li>Dashboard → HTTP → Routers</li><li>Or: <code>curl http://localhost:8080/api/http/routers | jq</code></li></ul><h3 id=services>Services</h3><p>Services define backend containers and load balancing.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.services.SERVICE_NAME.loadbalancer.server.port=3000&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.services.SERVICE_NAME.loadbalancer.server.scheme=http&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>View active services:</strong></p><ul><li>Dashboard → HTTP → Services</li></ul><h3 id=middlewares>Middlewares</h3><p>Middlewares process requests before reaching services.</p><p><strong>Authentik forward auth:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.SERVICE.middlewares=authentik@docker&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>Custom middlewares</strong> (defined in <code>authentik-server</code> labels):</p><ul><li><code>authentik@docker</code>: Forward authentication to Authentik</li><li><code>security-headers</code>: Add security headers</li><li><code>rate-limit</code>: Rate limiting</li></ul><h2 id=certificate-management>Certificate Management</h2><h3 id=dns-01-challenge>DNS-01 Challenge</h3><p>Traefik uses Cloudflare DNS-01 challenge to obtain certificates.</p><p><strong>Requirements:</strong></p><ul><li>Cloudflare account managing your domain</li><li>API token with <code>Zone:DNS:Edit</code> permission</li><li>Token in <code>.env</code> as <code>TRAEFIK_CLOUDFLARE_TOKEN</code></li></ul><p><strong>How it works:</strong></p><ol><li>Traefik requests certificate from Let&rsquo;s Encrypt</li><li>Let&rsquo;s Encrypt asks for DNS TXT record</li><li>Traefik creates record via Cloudflare API</li><li>Let&rsquo;s Encrypt verifies record and issues certificate</li><li>Traefik stores certificate in <code>acme.json</code></li></ol><h3 id=certificate-storage>Certificate Storage</h3><p>Certificates stored in <code>config/traefik/letsencrypt/acme.json</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View stored certificates</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik cat /letsencrypt/acme.json <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.cloudflare.Certificates&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check expiry</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik cat /letsencrypt/acme.json <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.cloudflare.Certificates[0].domain&#39;</span>
</span></span></code></pre></div><p><strong>Important:</strong></p><ul><li><code>acme.json</code> must have 600 permissions</li><li>Contains private keys - keep secure</li><li>Back up before major changes</li></ul><h3 id=certificate-dumper>Certificate Dumper</h3><p><code>traefik-certs-dumper</code> extracts PEM files from <code>acme.json</code> for other services (like AdGuard).</p><p><strong>Output location:</strong> <code>config/traefik/certs/</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View extracted certificates</span>
</span></span><span style=display:flex><span>ls -la config/traefik/certs/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Example structure:</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># config/traefik/certs/</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#   └── antoineglacet.com/</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#       ├── certificate.crt</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#       └── privatekey.key</span>
</span></span></code></pre></div><h3 id=wildcard-certificate>Wildcard Certificate</h3><p>Configured in <code>docker-compose.yml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>command</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- --<span style=color:#000>entrypoints.websecure.http.tls.domains[0].main=antoineglacet.com</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- --<span style=color:#000>entrypoints.websecure.http.tls.domains[0].sans=*.antoineglacet.com</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>This creates one certificate valid for:</p><ul><li><code>antoineglacet.com</code></li><li><code>*.antoineglacet.com</code> (all subdomains)</li></ul><h3 id=certificate-renewal>Certificate Renewal</h3><p>Traefik automatically renews certificates 30 days before expiry.</p><p><strong>Monitor renewals:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Watch Traefik logs for renewal activity</span>
</span></span><span style=display:flex><span>docker compose logs -f traefik <span style=color:#000;font-weight:700>|</span> grep -i <span style=color:#4e9a06>&#34;renew\|certificate&#34;</span>
</span></span></code></pre></div><p><strong>Force renewal:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Delete acme.json and restart Traefik</span>
</span></span><span style=display:flex><span>rm config/traefik/letsencrypt/acme.json
</span></span><span style=display:flex><span>docker compose restart traefik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Watch logs to see new certificate request</span>
</span></span><span style=display:flex><span>docker compose logs -f traefik
</span></span></code></pre></div><h2 id=exposing-services>Exposing Services</h2><h3 id=basic-service-exposure>Basic Service Exposure</h3><p>Add these labels to your service in <code>docker-compose.yml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>myservice</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>myimage:latest</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>networks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>homelab</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#000>homelab_proxy</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Enable Traefik for this service</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.enable=true&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Specify which network Traefik should use</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.docker.network=homelab_proxy&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Define routing rule (hostname)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.rule=Host(`myservice.${TRAEFIK_DOMAIN}`)&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Use HTTPS entry point</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.entrypoints=websecure&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Use Cloudflare certificate resolver</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.tls.certresolver=cloudflare&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># Specify container port</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span>- <span style=color:#4e9a06>&#34;traefik.http.services.myservice.loadbalancer.server.port=8080&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=adding-authentication>Adding Authentication</h3><p>Protect service with Authentik forward auth:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># ... basic labels above ...</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.middlewares=authentik@docker&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=host-network-services>Host Network Services</h3><p>For services using <code>network_mode: host</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.enable=true&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.rule=Host(`myservice.${TRAEFIK_DOMAIN}`)&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.entrypoints=websecure&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.tls.certresolver=cloudflare&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># Point to host.docker.internal</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.services.myservice.loadbalancer.server.url=http://host.docker.internal:8080&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>Example:</strong> Home Assistant, Plex</p><h3 id=multiple-routers>Multiple Routers</h3><p>Service can have multiple entry points:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># HTTP router (redirects to HTTPS)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice-http.rule=Host(`myservice.${TRAEFIK_DOMAIN}`)&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice-http.entrypoints=web&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice-http.middlewares=redirect-to-https&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># HTTPS router</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.rule=Host(`myservice.${TRAEFIK_DOMAIN}`)&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.entrypoints=websecure&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span>- <span style=color:#4e9a06>&#34;traefik.http.routers.myservice.tls.certresolver=cloudflare&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=monitoring>Monitoring</h2><h3 id=dashboard>Dashboard</h3><p>Access dashboard at <a href=https://traefik.antoineglacet.com>https://traefik.antoineglacet.com</a></p><p><strong>Shows:</strong></p><ul><li>Active routers and routing rules</li><li>Backend services and health</li><li>Middlewares</li><li>Certificate status</li><li>Real-time request metrics</li></ul><h3 id=prometheus-metrics>Prometheus Metrics</h3><p>Traefik exports metrics for Prometheus on port 8082.</p><p><strong>Available metrics:</strong></p><ul><li><code>traefik_entrypoint_requests_total</code>: Total requests per entry point</li><li><code>traefik_entrypoint_request_duration_seconds</code>: Request duration histogram</li><li><code>traefik_service_requests_total</code>: Requests per backend service</li><li><code>traefik_service_request_duration_seconds</code>: Backend response time</li></ul><p><strong>Query examples:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-promql data-lang=promql><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Request rate per service</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>rate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>traefik_service_requests_total</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>5m</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Average response time</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>avg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>traefik_service_request_duration_seconds_sum</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#000>traefik_service_request_duration_seconds_count</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Error rate</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>sum</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>rate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>traefik_service_requests_total</span><span style=color:#000;font-weight:700>{</span><span style=color:#f57900>code</span><span style=color:#ce5c00;font-weight:700>=~</span><span style=color:#000;font-weight:700>&#34;</span><span style=color:#4e9a06>5..</span><span style=color:#000;font-weight:700>&#34;}[</span><span style=color:#4e9a06>5m</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>))</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=logs>Logs</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Follow all Traefik logs</span>
</span></span><span style=display:flex><span>docker compose logs -f traefik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Filter for errors</span>
</span></span><span style=display:flex><span>docker compose logs -f traefik <span style=color:#000;font-weight:700>|</span> grep -i error
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Filter for specific service</span>
</span></span><span style=display:flex><span>docker compose logs -f traefik <span style=color:#000;font-weight:700>|</span> grep myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check access logs</span>
</span></span><span style=display:flex><span>docker compose logs traefik <span style=color:#000;font-weight:700>|</span> grep <span style=color:#4e9a06>&#34;HTTP/1.1\&#34; 200&#34;</span>
</span></span></code></pre></div><h3 id=health-check>Health Check</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Ping Traefik</span>
</span></span><span style=display:flex><span>curl http://localhost:8080/ping
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should return: OK</span>
</span></span></code></pre></div><h2 id=troubleshooting>Troubleshooting</h2><h3 id=certificate-issues>Certificate Issues</h3><h4 id=certificate-not-issued>Certificate not issued</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check Traefik logs</span>
</span></span><span style=display:flex><span>docker compose logs traefik <span style=color:#000;font-weight:700>|</span> grep -i <span style=color:#4e9a06>&#34;certificate\|acme\|error&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Verify Cloudflare token</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik env <span style=color:#000;font-weight:700>|</span> grep CLOUDFLARE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Test Cloudflare API access</span>
</span></span><span style=display:flex><span>curl -X GET <span style=color:#4e9a06>&#34;https://api.cloudflare.com/client/v4/user/tokens/verify&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span>  -H <span style=color:#4e9a06>&#34;Authorization: Bearer </span><span style=color:#000>$TRAEFIK_CLOUDFLARE_TOKEN</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span>  -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Check acme.json permissions</span>
</span></span><span style=display:flex><span>ls -la config/traefik/letsencrypt/acme.json
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should be: -rw------- (600)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 5. Force new certificate</span>
</span></span><span style=display:flex><span>rm config/traefik/letsencrypt/acme.json
</span></span><span style=display:flex><span>docker compose restart traefik
</span></span></code></pre></div><h4 id=certificate-expired>Certificate expired</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should auto-renew 30 days before expiry</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If not, check logs:</span>
</span></span><span style=display:flex><span>docker compose logs traefik <span style=color:#000;font-weight:700>|</span> grep -i renew
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Force renewal:</span>
</span></span><span style=display:flex><span>rm config/traefik/letsencrypt/acme.json
</span></span><span style=display:flex><span>docker compose restart traefik
</span></span></code></pre></div><h3 id=routing-issues>Routing Issues</h3><h4 id=service-not-accessible>Service not accessible</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check service is running</span>
</span></span><span style=display:flex><span>docker compose ps myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Verify Traefik labels</span>
</span></span><span style=display:flex><span>docker inspect myservice <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[0].Config.Labels&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Check if router exists in Traefik</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Dashboard → HTTP → Routers → look for myservice</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Verify service is on homelab_proxy network</span>
</span></span><span style=display:flex><span>docker inspect myservice <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[0].NetworkSettings.Networks&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 5. Test from inside Traefik container</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik wget -O- http://myservice:8080
</span></span></code></pre></div><h4 id=404-not-found>404 Not Found</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Router not matching request</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check Host rule matches exactly</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Verify DNS points to server</span>
</span></span><span style=display:flex><span>nslookup myservice.antoineglacet.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Check Traefik dashboard for router</span>
</span></span></code></pre></div><h4 id=502-bad-gateway>502 Bad Gateway</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Backend service unreachable</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check service is running</span>
</span></span><span style=display:flex><span>docker compose ps myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Verify port in labels matches container</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik wget -O- http://myservice:XXXX
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Check service logs</span>
</span></span><span style=display:flex><span>docker compose logs myservice
</span></span></code></pre></div><h4 id=503-service-unavailable>503 Service Unavailable</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># No backend available</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Service not on correct network</span>
</span></span><span style=display:flex><span>docker inspect myservice <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[0].NetworkSettings.Networks&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Service not started</span>
</span></span><span style=display:flex><span>docker compose ps myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Health check failing</span>
</span></span><span style=display:flex><span>docker inspect myservice <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[0].State.Health&#39;</span>
</span></span></code></pre></div><h3 id=authentik-middleware-issues>Authentik Middleware Issues</h3><h4 id=authentication-loop>Authentication loop</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Clear browser cookies for *.antoineglacet.com</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Check Authentik is running</span>
</span></span><span style=display:flex><span>docker compose ps <span style=color:#000;font-weight:700>|</span> grep authentik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Verify middleware configuration</span>
</span></span><span style=display:flex><span>docker inspect authentik-server <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[0].Config.Labels&#39;</span> <span style=color:#000;font-weight:700>|</span> grep middleware
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Check Authentik logs</span>
</span></span><span style=display:flex><span>docker compose logs authentik-server <span style=color:#000;font-weight:700>|</span> tail -50
</span></span></code></pre></div><h3 id=performance-issues>Performance Issues</h3><h4 id=slow-response-times>Slow response times</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check Traefik metrics</span>
</span></span><span style=display:flex><span>curl http://localhost:8082/metrics <span style=color:#000;font-weight:700>|</span> grep duration
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Check if backend is slow</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik <span style=color:#204a87>time</span> wget -O- http://myservice:8080
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Enable access logs for debugging</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add to docker-compose.yml command:</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># - --accesslog=true</span>
</span></span></code></pre></div><h4 id=high-cpumemory-usage>High CPU/memory usage</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Check Traefik resource usage</span>
</span></span><span style=display:flex><span>docker stats traefik
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Review number of active connections</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Dashboard → Overview</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Consider adding rate limiting</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># - &#34;traefik.http.middlewares.rate-limit.ratelimit.average=100&#34;</span>
</span></span></code></pre></div><h3 id=checking-configuration>Checking Configuration</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View full Traefik configuration</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik cat /etc/traefik/traefik.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View dynamic configuration (from Docker labels)</span>
</span></span><span style=display:flex><span>curl http://localhost:8080/api/http/routers <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span>curl http://localhost:8080/api/http/services <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span>curl http://localhost:8080/api/http/middlewares <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Validate configuration</span>
</span></span><span style=display:flex><span>docker compose config traefik
</span></span></code></pre></div><h3 id=common-mistakes>Common Mistakes</h3><ol><li><p><strong>Service not on homelab_proxy network</strong></p><ul><li>Solution: Add to both <code>homelab</code> and <code>homelab_proxy</code> networks</li></ul></li><li><p><strong>Wrong port in labels</strong></p><ul><li>Solution: Use container&rsquo;s internal port, not published port</li></ul></li><li><p><strong>Missing traefik.docker.network label</strong></p><ul><li>Solution: Add <code>traefik.docker.network=homelab_proxy</code></li></ul></li><li><p><strong>DNS not pointing to server</strong></p><ul><li>Solution: Verify A record in Cloudflare</li></ul></li><li><p><strong>Firewall blocking port 443</strong></p><ul><li>Solution: Check <code>ufw</code> or <code>iptables</code></li></ul></li></ol><h3 id=debugging-workflow>Debugging Workflow</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 1. Verify service is running</span>
</span></span><span style=display:flex><span>docker compose ps myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 2. Check service logs</span>
</span></span><span style=display:flex><span>docker compose logs myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 3. Check Traefik can reach service</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik wget -O- http://myservice:PORT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 4. Verify DNS resolves</span>
</span></span><span style=display:flex><span>nslookup myservice.antoineglacet.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 5. Check Traefik logs</span>
</span></span><span style=display:flex><span>docker compose logs traefik <span style=color:#000;font-weight:700>|</span> grep myservice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 6. Verify certificate exists</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> traefik cat /letsencrypt/acme.json <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.cloudflare.Certificates&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 7. Test from outside</span>
</span></span><span style=display:flex><span>curl -v https://myservice.antoineglacet.com
</span></span></code></pre></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Homepage aria-label=Homepage><a target=_blank rel=noopener href=https://homepage.antoineglacet.com aria-label=Homepage><i class="fa fa-home"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2026
<span class=td-footer__authors>Antoine Glacet</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.258190f24d50bde9095e369c0cd7315407f95e1da5f39472b3850b40279a9e08.js integrity="sha256-JYGQ8k1QvekJXjacDNcxVAf5Xh2l85Rys4ULQCeangg=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>