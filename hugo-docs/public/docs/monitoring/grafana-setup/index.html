<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Grafana Setup Guide | Home Server Documentation</title><meta name=description content="Setting up Grafana with automatic datasource provisioning and pre-configured dashboards"><meta property="og:url" content="https://docs.antoineglacet.com/docs/monitoring/grafana-setup/"><meta property="og:site_name" content="Home Server Documentation"><meta property="og:title" content="Grafana Setup Guide"><meta property="og:description" content="Setting up Grafana with automatic datasource provisioning and pre-configured dashboards"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="Grafana Setup Guide"><meta itemprop=description content="Setting up Grafana with automatic datasource provisioning and pre-configured dashboards"><meta itemprop=wordCount content="722"><meta name=twitter:card content="summary"><meta name=twitter:title content="Grafana Setup Guide"><meta name=twitter:description content="Setting up Grafana with automatic datasource provisioning and pre-configured dashboards"><link rel=preload href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css as=style integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><link href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css rel=stylesheet integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Home Server Documentation</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class="nav-link active" href=/docs/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=https://homepage.antoineglacet.com target=_blank rel=noopener><span>Homepage</span></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-docsmonitoringgrafana-setup").addClass("active"),$("#td-section-nav #m-docsmonitoringgrafana-setup-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-docsmonitoringgrafana-setup").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-docsmonitoringgrafana-setup-li").siblings("li").addClass("show"),$("#td-section-nav #m-docsmonitoringgrafana-setup-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs-li><a href=/docs/ title=Documentation class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Docs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsoperations-li><input type=checkbox id=m-docsoperations-check>
<label for=m-docsoperations-check><a href=/docs/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsoperations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsoperating-li><input type=checkbox id=m-docsoperationsoperating-check>
<label for=m-docsoperationsoperating-check><a href=/docs/operations/operating/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsoperating><span>Operating Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsquick_start-li><input type=checkbox id=m-docsoperationsquick_start-check>
<label for=m-docsoperationsquick_start-check><a href=/docs/operations/quick_start/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsquick_start><span>Quick Start: Fix SSH Lag & LAN Latency</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance-tuning-li><input type=checkbox id=m-docsoperationsperformance-tuning-check>
<label for=m-docsoperationsperformance-tuning-check><a href=/docs/operations/performance-tuning/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance-tuning><span>Performance Tuning Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance_optimization-li><input type=checkbox id=m-docsoperationsperformance_optimization-check>
<label for=m-docsoperationsperformance_optimization-check><a href=/docs/operations/performance_optimization/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance_optimization><span>Performance Optimization Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsinfrastructure-li><input type=checkbox id=m-docsinfrastructure-check>
<label for=m-docsinfrastructure-check><a href=/docs/infrastructure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsinfrastructure><span>Infrastructure</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructuretraefik-li><input type=checkbox id=m-docsinfrastructuretraefik-check>
<label for=m-docsinfrastructuretraefik-check><a href=/docs/infrastructure/traefik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructuretraefik><span>Traefik - Reverse Proxy & TLS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructureauthentik-li><input type=checkbox id=m-docsinfrastructureauthentik-check>
<label for=m-docsinfrastructureauthentik-check><a href=/docs/infrastructure/authentik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructureauthentik><span>Authentik - SSO & Authentication</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsmonitoring-li><input type=checkbox id=m-docsmonitoring-check>
<label for=m-docsmonitoring-check><a href=/docs/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsmonitoring><span>Monitoring</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringmonitoring-li><input type=checkbox id=m-docsmonitoringmonitoring-check>
<label for=m-docsmonitoringmonitoring-check><a href=/docs/monitoring/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringmonitoring><span>Monitoring & Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringgrafana-setup-li><input type=checkbox id=m-docsmonitoringgrafana-setup-check>
<label for=m-docsmonitoringgrafana-setup-check><a href=/docs/monitoring/grafana-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringgrafana-setup><span>Grafana Setup Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docstroubleshooting-li><input type=checkbox id=m-docstroubleshooting-check>
<label for=m-docstroubleshooting-check><a href=/docs/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docstroubleshooting><span>Troubleshooting</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstroubleshootingtroubleshooting-li><input type=checkbox id=m-docstroubleshootingtroubleshooting-check>
<label for=m-docstroubleshootingtroubleshooting-check><a href=/docs/troubleshooting/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docstroubleshootingtroubleshooting><span>Troubleshooting Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdeployment-li><input type=checkbox id=m-docsdeployment-check>
<label for=m-docsdeployment-check><a href=/docs/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdeployment><span>Deployment</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_checklist-li><input type=checkbox id=m-docsdeploymentdeployment_checklist-check>
<label for=m-docsdeploymentdeployment_checklist-check><a href=/docs/deployment/deployment_checklist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_checklist><span>Deployment Checklist - Infrastructure Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentpost-commit-steps-li><input type=checkbox id=m-docsdeploymentpost-commit-steps-check>
<label for=m-docsdeploymentpost-commit-steps-check><a href=/docs/deployment/post-commit-steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentpost-commit-steps><span>Post-Commit Setup Steps</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_notes-li><input type=checkbox id=m-docsdeploymentdeployment_notes-check>
<label for=m-docsdeploymentdeployment_notes-check><a href=/docs/deployment/deployment_notes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_notes><span>Deployment Notes - 2026-01-16</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymenthugo-site-setup-li><input type=checkbox id=m-docsdeploymenthugo-site-setup-check>
<label for=m-docsdeploymenthugo-site-setup-check><a href=/docs/deployment/hugo-site-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymenthugo-site-setup><span>Hugo Documentation Site - Setup Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentalerting_migration-li><input type=checkbox id=m-docsdeploymentalerting_migration-check>
<label for=m-docsdeploymentalerting_migration-check><a href=/docs/deployment/alerting_migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentalerting_migration><span>Alerting Migration to Grafana</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentreadme-li><input type=checkbox id=m-docsdeploymentreadme-check>
<label for=m-docsdeploymentreadme-check><a href=/docs/deployment/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentreadme><span></span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsplanning-li><input type=checkbox id=m-docsplanning-check>
<label for=m-docsplanning-check><a href=/docs/planning/ title="Planning & Status" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsplanning><span>Planning</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningimplementation_status-li><input type=checkbox id=m-docsplanningimplementation_status-check>
<label for=m-docsplanningimplementation_status-check><a href=/docs/planning/implementation_status/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningimplementation_status><span>Implementation Status - Home Server Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningnext_steps-li><input type=checkbox id=m-docsplanningnext_steps-check>
<label for=m-docsplanningnext_steps-check><a href=/docs/planning/next_steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningnext_steps><span>Next Steps - Alerting Migration Testing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningsecurity_remediation-li><input type=checkbox id=m-docsplanningsecurity_remediation-check>
<label for=m-docsplanningsecurity_remediation-check><a href=/docs/planning/security_remediation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningsecurity_remediation><span>Security Remediation: Discord Webhook Leak</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningreadme-li><input type=checkbox id=m-docsplanningreadme-check>
<label for=m-docsplanningreadme-check><a href=/docs/planning/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningreadme><span></span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#automatic-datasource-configuration>Automatic Datasource Configuration</a><ul><li><a href=#create-datasources-configuration>Create Datasources Configuration</a></li><li><a href=#verify-datasources>Verify Datasources</a></li></ul></li><li><a href=#dashboard-provisioning>Dashboard Provisioning</a><ul><li><a href=#setup-dashboard-provisioning>Setup Dashboard Provisioning</a></li><li><a href=#import-dashboards>Import Dashboards</a></li></ul></li><li><a href=#manual-datasource-configuration-alternative>Manual Datasource Configuration (Alternative)</a><ul><li><a href=#add-prometheus>Add Prometheus</a></li><li><a href=#add-loki>Add Loki</a></li></ul></li><li><a href=#importing-dashboards-manually>Importing Dashboards Manually</a></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#datasources-dont-appear>Datasources Don&rsquo;t Appear</a></li><li><a href=#dashboard-import-fails>Dashboard Import Fails</a></li><li><a href=#metrics-not-showing>Metrics Not Showing</a></li><li><a href=#loki-logs-not-appearing>Loki Logs Not Appearing</a></li></ul></li><li><a href=#alertmanager-integration>Alertmanager Integration</a></li><li><a href=#useful-queries>Useful Queries</a><ul><li><a href=#prometheus-queries>Prometheus Queries</a></li><li><a href=#loki-queries>Loki Queries</a></li></ul></li><li><a href=#next-steps>Next Steps</a></li><li><a href=#references>References</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/monitoring/>Monitoring</a></li><li class="breadcrumb-item active" aria-current=page>Grafana Setup Guide</li></ol></nav><div class=td-content><h1>Grafana Setup Guide</h1><div class=lead>Setting up Grafana with automatic datasource provisioning and pre-configured dashboards</div><header class=article-meta></header><p>This guide covers setting up Grafana with automatic datasource provisioning and pre-configured dashboards.</p><h2 id=automatic-datasource-configuration>Automatic Datasource Configuration</h2><p>Grafana can automatically configure Prometheus and Loki datasources on startup.</p><h3 id=create-datasources-configuration>Create Datasources Configuration</h3><p>Run these commands to set up datasource provisioning:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create datasources directory (requires sudo due to Grafana container ownership)</span>
</span></span><span style=display:flex><span>sudo mkdir -p config/grafana/provisioning/datasources
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create the datasources configuration file</span>
</span></span><span style=display:flex><span>sudo tee config/grafana/provisioning/datasources/datasources.yml &gt; /dev/null <span style=color:#4e9a06>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>datasources:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - name: Prometheus
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: prometheus
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    access: proxy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    url: http://prometheus:9090
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    isDefault: true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    editable: false
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    jsonData:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      timeInterval: 15s
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      httpMethod: POST
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - name: Loki
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: loki
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    access: proxy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    url: http://loki:3100
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    editable: false
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    jsonData:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxLines: 1000
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      derivedFields:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - datasourceUid: Prometheus
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          matcherRegex: &#34;traceID=(\\w+)&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          name: TraceID
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          url: &#34;$${__value.raw}&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Fix ownership (Grafana runs as UID 1000)</span>
</span></span><span style=display:flex><span>sudo chown -R 1000:1000 config/grafana/provisioning
</span></span></code></pre></div><h3 id=verify-datasources>Verify Datasources</h3><p>After restarting Grafana:</p><ol><li>Navigate to <strong>Configuration → Data Sources</strong></li><li>You should see:<ul><li><strong>Prometheus</strong> (default) - Green checkmark</li><li><strong>Loki</strong> - Green checkmark</li></ul></li></ol><h2 id=dashboard-provisioning>Dashboard Provisioning</h2><p>Grafana can also automatically load dashboards from JSON files.</p><h3 id=setup-dashboard-provisioning>Setup Dashboard Provisioning</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create dashboards provisioning config</span>
</span></span><span style=display:flex><span>sudo tee config/grafana/provisioning/dashboards.yml &gt; /dev/null <span style=color:#4e9a06>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>providers:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - name: &#39;default&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    orgId: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    folder: &#39;Home Server&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: file
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    disableDeletion: false
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    updateIntervalSeconds: 10
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    allowUiUpdates: true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    options:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      path: /etc/grafana/dashboards
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Fix ownership</span>
</span></span><span style=display:flex><span>sudo chown 1000:1000 config/grafana/provisioning/dashboards.yml
</span></span></code></pre></div><h3 id=import-dashboards>Import Dashboards</h3><p>The following dashboards are included in this repository:</p><ol><li><p><strong>Home Server Overview</strong> (<code>config/grafana/dashboards/home-server-overview.json</code>)</p><ul><li>System resources (CPU, RAM, Swap, Disk)</li><li>Container status and resource usage</li><li>Disk usage trends</li><li>Swap usage monitoring</li></ul></li><li><p><strong>Media Pipeline</strong> (<code>config/grafana/dashboards/media-pipeline.json</code>)</p><ul><li>Sonarr/Radarr/Prowlarr statistics</li><li>Download activity and speeds</li><li>Library growth over time</li><li>Disk space for media</li></ul></li><li><p><strong>Network & Security</strong> (<code>config/grafana/dashboards/network-security.json</code>)</p><ul><li>Traefik request metrics</li><li>HTTP status code distribution</li><li>Authentication failures</li><li>VPN status and bandwidth</li><li>AdGuard DNS statistics</li></ul></li></ol><p>Dashboards will automatically reload when the JSON files are updated.</p><h2 id=manual-datasource-configuration-alternative>Manual Datasource Configuration (Alternative)</h2><p>If automatic provisioning doesn&rsquo;t work, configure datasources manually:</p><h3 id=add-prometheus>Add Prometheus</h3><ol><li>Go to <strong>Configuration → Data Sources → Add data source</strong></li><li>Select <strong>Prometheus</strong></li><li>Configure:<ul><li><strong>Name:</strong> Prometheus</li><li><strong>URL:</strong> <code>http://prometheus:9090</code></li><li><strong>Access:</strong> Server (default)</li></ul></li><li>Click <strong>Save & Test</strong></li></ol><h3 id=add-loki>Add Loki</h3><ol><li>Go to <strong>Configuration → Data Sources → Add data source</strong></li><li>Select <strong>Loki</strong></li><li>Configure:<ul><li><strong>Name:</strong> Loki</li><li><strong>URL:</strong> <code>http://loki:3100</code></li><li><strong>Access:</strong> Server (default)</li></ul></li><li>Click <strong>Save & Test</strong></li></ol><h2 id=importing-dashboards-manually>Importing Dashboards Manually</h2><p>If dashboard provisioning doesn&rsquo;t work:</p><ol><li>Go to <strong>Dashboards → Import</strong></li><li>Click <strong>Upload JSON file</strong></li><li>Select a dashboard file from <code>config/grafana/dashboards/</code></li><li>Configure:<ul><li><strong>Folder:</strong> Home Server (or create new)</li><li><strong>Prometheus datasource:</strong> Prometheus</li><li><strong>Loki datasource:</strong> Loki</li></ul></li><li>Click <strong>Import</strong></li></ol><p>Repeat for each dashboard.</p><h2 id=troubleshooting>Troubleshooting</h2><h3 id=datasources-dont-appear>Datasources Don&rsquo;t Appear</h3><p>Check Grafana logs:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose logs grafana <span style=color:#000;font-weight:700>|</span> grep -i datasource
</span></span></code></pre></div><p>Common issues:</p><ul><li>Ownership problem: <code>sudo chown -R 1000:1000 config/grafana/provisioning</code></li><li>YAML syntax error: Validate with <code>yamllint config/grafana/provisioning/datasources/datasources.yml</code></li><li>Grafana needs restart: <code>docker compose restart grafana</code></li></ul><h3 id=dashboard-import-fails>Dashboard Import Fails</h3><ul><li>Verify JSON syntax: <code>jq . config/grafana/dashboards/dashboard-name.json</code></li><li>Check Grafana version compatibility</li><li>Ensure datasources are configured first</li></ul><h3 id=metrics-not-showing>Metrics Not Showing</h3><ol><li><p>Verify Prometheus is scraping targets:</p><ul><li>Navigate to <code>http://localhost:9090/targets</code></li><li>All targets should show &ldquo;UP&rdquo; status</li></ul></li><li><p>Check Prometheus configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> prometheus promtool check config /etc/prometheus/prometheus.yml
</span></span></code></pre></div></li><li><p>Verify containers are exposing metrics:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Test Traefik metrics</span>
</span></span><span style=display:flex><span>curl http://localhost:8082/metrics
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Test Loki metrics</span>
</span></span><span style=display:flex><span>curl http://localhost:3100/metrics
</span></span></code></pre></div></li></ol><h3 id=loki-logs-not-appearing>Loki Logs Not Appearing</h3><ol><li><p>Check Promtail is running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose ps promtail
</span></span><span style=display:flex><span>docker compose logs promtail --tail<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>50</span>
</span></span></code></pre></div></li><li><p>Verify Promtail configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> promtail cat /etc/promtail/config.yaml
</span></span></code></pre></div></li><li><p>Test Loki query:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># List log streams</span>
</span></span><span style=display:flex><span>curl -G -s http://localhost:3100/loki/api/v1/label/__name__/values
</span></span></code></pre></div></li></ol><h2 id=alertmanager-integration>Alertmanager Integration</h2><p>Once Alertmanager is configured, add it as a contact point:</p><ol><li>Go to <strong>Alerting → Contact points</strong></li><li>Click <strong>New contact point</strong></li><li>Configure:<ul><li><strong>Name:</strong> Alertmanager</li><li><strong>Integration:</strong> Alertmanager</li><li><strong>URL:</strong> <code>http://alertmanager:9093</code></li></ul></li><li>Click <strong>Save contact point</strong></li></ol><p>This allows Grafana alerts to route through Alertmanager for unified alert management.</p><h2 id=useful-queries>Useful Queries</h2><h3 id=prometheus-queries>Prometheus Queries</h3><p>System metrics:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-promql data-lang=promql><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Memory usage percentage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>node_memory_MemAvailable_bytes</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#000>node_memory_MemTotal_bytes</span><span style=color:#ce5c00;font-weight:700>))</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Swap usage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>node_memory_SwapTotal_bytes</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#f8f8f8> </span><span style=color:#000>node_memory_SwapFree_bytes</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Disk usage percentage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>node_filesystem_avail_bytes</span><span style=color:#000;font-weight:700>{</span><span style=color:#f57900>mountpoint</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>&#34;</span><span style=color:#4e9a06>/media/data</span><span style=color:#000;font-weight:700>&#34;}</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8> </span><span style=color:#000>node_filesystem_size_bytes</span><span style=color:#000;font-weight:700>{</span><span style=color:#f57900>mountpoint</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>&#34;</span><span style=color:#4e9a06>/media/data</span><span style=color:#000;font-weight:700>&#34;}</span><span style=color:#ce5c00;font-weight:700>))</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># CPU usage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>avg</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>by</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>instance</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>rate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>node_cpu_seconds_total</span><span style=color:#000;font-weight:700>{</span><span style=color:#f57900>mode</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>&#34;</span><span style=color:#4e9a06>idle</span><span style=color:#000;font-weight:700>&#34;}[</span><span style=color:#4e9a06>5m</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>))</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Container memory usage</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>container_memory_usage_bytes</span><span style=color:#000;font-weight:700>{</span><span style=color:#f57900>name</span><span style=color:#ce5c00;font-weight:700>!=</span><span style=color:#000;font-weight:700>&#34;&#34;}</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=loki-queries>Loki Queries</h3><p>Container logs:</p><pre tabindex=0><code class=language-logql data-lang=logql># All logs from a container
{container_name=&#34;sonarr&#34;}

# Errors in last hour
{container_name=~&#34;.+&#34;} |= &#34;error&#34; | line_format &#34;{{.container_name}}: {{.log}}&#34;

# Failed auth attempts
{container_name=&#34;traefik&#34;} |~ &#34;401|403&#34;

# Recent errors across all containers
{container_name=~&#34;.+&#34;} |= &#34;level=error&#34; or |= &#34;ERROR&#34; or |= &#34;FATAL&#34;
</code></pre><h2 id=next-steps>Next Steps</h2><ol><li>Configure Alertmanager for webhook notifications (see <code>docs/alertmanager-setup.md</code>)</li><li>Create custom dashboards for specific use cases</li><li>Set up Grafana authentication via Authentik (OAuth2)</li><li>Configure alert rules in Grafana (in addition to Prometheus alerts)</li><li>Export dashboards regularly for backup: <strong>Dashboard → Settings → JSON Model → Copy</strong></li></ol><h2 id=references>References</h2><ul><li><a href=https://grafana.com/docs/grafana/latest/administration/provisioning/>Grafana Provisioning Docs</a></li><li><a href=https://grafana.com/docs/grafana/latest/datasources/prometheus/>Prometheus Datasource Config</a></li><li><a href=https://grafana.com/docs/grafana/latest/datasources/loki/>Loki Datasource Config</a></li><li><a href=https://grafana.com/docs/grafana/latest/dashboards/json-model/>Dashboard JSON Model</a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Homepage aria-label=Homepage><a target=_blank rel=noopener href=https://homepage.antoineglacet.com aria-label=Homepage><i class="fa fa-home"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2026
<span class=td-footer__authors>Antoine Glacet</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.258190f24d50bde9095e369c0cd7315407f95e1da5f39472b3850b40279a9e08.js integrity="sha256-JYGQ8k1QvekJXjacDNcxVAf5Xh2l85Rys4ULQCeangg=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>