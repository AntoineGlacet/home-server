<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Performance Tuning Guide | Home Server Documentation</title><meta name=description content="Performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers"><meta property="og:url" content="https://docs.antoineglacet.com/docs/operations/performance-tuning/"><meta property="og:site_name" content="Home Server Documentation"><meta property="og:title" content="Performance Tuning Guide"><meta property="og:description" content="Performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="Performance Tuning Guide"><meta itemprop=description content="Performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers"><meta itemprop=wordCount content="1059"><meta name=twitter:card content="summary"><meta name=twitter:title content="Performance Tuning Guide"><meta name=twitter:description content="Performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers"><link rel=preload href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css as=style integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><link href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css rel=stylesheet integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Home Server Documentation</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class="nav-link active" href=/docs/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=https://homepage.antoineglacet.com target=_blank rel=noopener><span>Homepage</span></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-docsoperationsperformance-tuning").addClass("active"),$("#td-section-nav #m-docsoperationsperformance-tuning-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-docsoperationsperformance-tuning").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-docsoperationsperformance-tuning-li").siblings("li").addClass("show"),$("#td-section-nav #m-docsoperationsperformance-tuning-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs-li><a href=/docs/ title=Documentation class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Docs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsoperations-li><input type=checkbox id=m-docsoperations-check>
<label for=m-docsoperations-check><a href=/docs/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsoperations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsoperating-li><input type=checkbox id=m-docsoperationsoperating-check>
<label for=m-docsoperationsoperating-check><a href=/docs/operations/operating/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsoperating><span>Operating Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsquick_start-li><input type=checkbox id=m-docsoperationsquick_start-check>
<label for=m-docsoperationsquick_start-check><a href=/docs/operations/quick_start/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsquick_start><span>Quick Start: Fix SSH Lag & LAN Latency</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance-tuning-li><input type=checkbox id=m-docsoperationsperformance-tuning-check>
<label for=m-docsoperationsperformance-tuning-check><a href=/docs/operations/performance-tuning/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance-tuning><span>Performance Tuning Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance_optimization-li><input type=checkbox id=m-docsoperationsperformance_optimization-check>
<label for=m-docsoperationsperformance_optimization-check><a href=/docs/operations/performance_optimization/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance_optimization><span>Performance Optimization Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsinfrastructure-li><input type=checkbox id=m-docsinfrastructure-check>
<label for=m-docsinfrastructure-check><a href=/docs/infrastructure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsinfrastructure><span>Infrastructure</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructuretraefik-li><input type=checkbox id=m-docsinfrastructuretraefik-check>
<label for=m-docsinfrastructuretraefik-check><a href=/docs/infrastructure/traefik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructuretraefik><span>Traefik - Reverse Proxy & TLS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructureauthentik-li><input type=checkbox id=m-docsinfrastructureauthentik-check>
<label for=m-docsinfrastructureauthentik-check><a href=/docs/infrastructure/authentik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructureauthentik><span>Authentik - SSO & Authentication</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsmonitoring-li><input type=checkbox id=m-docsmonitoring-check>
<label for=m-docsmonitoring-check><a href=/docs/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsmonitoring><span>Monitoring</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringmonitoring-li><input type=checkbox id=m-docsmonitoringmonitoring-check>
<label for=m-docsmonitoringmonitoring-check><a href=/docs/monitoring/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringmonitoring><span>Monitoring & Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringgrafana-setup-li><input type=checkbox id=m-docsmonitoringgrafana-setup-check>
<label for=m-docsmonitoringgrafana-setup-check><a href=/docs/monitoring/grafana-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringgrafana-setup><span>Grafana Setup Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docstroubleshooting-li><input type=checkbox id=m-docstroubleshooting-check>
<label for=m-docstroubleshooting-check><a href=/docs/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docstroubleshooting><span>Troubleshooting</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstroubleshootingtroubleshooting-li><input type=checkbox id=m-docstroubleshootingtroubleshooting-check>
<label for=m-docstroubleshootingtroubleshooting-check><a href=/docs/troubleshooting/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docstroubleshootingtroubleshooting><span>Troubleshooting Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdeployment-li><input type=checkbox id=m-docsdeployment-check>
<label for=m-docsdeployment-check><a href=/docs/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdeployment><span>Deployment</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_checklist-li><input type=checkbox id=m-docsdeploymentdeployment_checklist-check>
<label for=m-docsdeploymentdeployment_checklist-check><a href=/docs/deployment/deployment_checklist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_checklist><span>Deployment Checklist - Infrastructure Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentpost-commit-steps-li><input type=checkbox id=m-docsdeploymentpost-commit-steps-check>
<label for=m-docsdeploymentpost-commit-steps-check><a href=/docs/deployment/post-commit-steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentpost-commit-steps><span>Post-Commit Setup Steps</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_notes-li><input type=checkbox id=m-docsdeploymentdeployment_notes-check>
<label for=m-docsdeploymentdeployment_notes-check><a href=/docs/deployment/deployment_notes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_notes><span>Deployment Notes - 2026-01-16</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymenthugo-site-setup-li><input type=checkbox id=m-docsdeploymenthugo-site-setup-check>
<label for=m-docsdeploymenthugo-site-setup-check><a href=/docs/deployment/hugo-site-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymenthugo-site-setup><span>Hugo Documentation Site - Setup Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentalerting_migration-li><input type=checkbox id=m-docsdeploymentalerting_migration-check>
<label for=m-docsdeploymentalerting_migration-check><a href=/docs/deployment/alerting_migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentalerting_migration><span>Alerting Migration to Grafana</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentreadme-li><input type=checkbox id=m-docsdeploymentreadme-check>
<label for=m-docsdeploymentreadme-check><a href=/docs/deployment/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentreadme><span></span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsplanning-li><input type=checkbox id=m-docsplanning-check>
<label for=m-docsplanning-check><a href=/docs/planning/ title="Planning & Status" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsplanning><span>Planning</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningimplementation_status-li><input type=checkbox id=m-docsplanningimplementation_status-check>
<label for=m-docsplanningimplementation_status-check><a href=/docs/planning/implementation_status/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningimplementation_status><span>Implementation Status - Home Server Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningnext_steps-li><input type=checkbox id=m-docsplanningnext_steps-check>
<label for=m-docsplanningnext_steps-check><a href=/docs/planning/next_steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningnext_steps><span>Next Steps - Alerting Migration Testing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningsecurity_remediation-li><input type=checkbox id=m-docsplanningsecurity_remediation-check>
<label for=m-docsplanningsecurity_remediation-check><a href=/docs/planning/security_remediation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningsecurity_remediation><span>Security Remediation: Discord Webhook Leak</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningreadme-li><input type=checkbox id=m-docsplanningreadme-check>
<label for=m-docsplanningreadme-check><a href=/docs/planning/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningreadme><span></span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#system-specifications>System Specifications</a></li><li><a href=#critical-issue-swap-thrashing>Critical Issue: Swap Thrashing</a><ul><li><a href=#problem>Problem</a></li><li><a href=#why-this-happens>Why This Happens</a></li><li><a href=#current-state-analysis>Current State Analysis</a></li></ul></li><li><a href=#solution-reduce-swappiness-to-10>Solution: Reduce Swappiness to 10</a><ul><li><a href=#temporary-change-testing>Temporary Change (Testing)</a></li><li><a href=#permanent-change-recommended>Permanent Change (Recommended)</a></li><li><a href=#optional-clear-swap-if-safe>Optional: Clear Swap (If Safe)</a></li></ul></li><li><a href=#expected-results>Expected Results</a><ul><li><a href=#monitoring-the-impact>Monitoring the Impact</a></li></ul></li><li><a href=#additional-performance-optimizations>Additional Performance Optimizations</a><ul><li><a href=#1-container-resource-limits>1. Container Resource Limits</a></li><li><a href=#2-disk-io-optimization>2. Disk I/O Optimization</a></li><li><a href=#3-cpu-governor>3. CPU Governor</a></li><li><a href=#4-swap-file-optimization>4. Swap File Optimization</a></li></ul></li><li><a href=#monitoring-performance>Monitoring Performance</a><ul><li><a href=#key-metrics-to-track>Key Metrics to Track</a></li><li><a href=#grafana-dashboard-queries>Grafana Dashboard Queries</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#high-swap-despite-low-swappiness>High Swap Despite Low Swappiness</a></li><li><a href=#oom-killer-triggered>OOM Killer Triggered</a></li><li><a href=#slow-performance-after-limits>Slow Performance After Limits</a></li></ul></li><li><a href=#verification-checklist>Verification Checklist</a></li><li><a href=#references>References</a></li><li><a href=#need-help>Need Help?</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/operations/>Operations</a></li><li class="breadcrumb-item active" aria-current=page>Performance Tuning Guide</li></ol></nav><div class=td-content><h1>Performance Tuning Guide</h1><div class=lead>Performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers</div><header class=article-meta></header><p>This guide covers performance optimizations for the Dell OptiPlex 3050 home server running 37+ Docker containers.</p><h2 id=system-specifications>System Specifications</h2><ul><li><strong>CPU:</strong> Intel Core i5-7500T (4 cores @ 2.70GHz)</li><li><strong>RAM:</strong> 8GB DDR4</li><li><strong>Storage:</strong> 98GB system drive + 5.5TB data drive</li><li><strong>OS:</strong> Ubuntu 24.04.3 LTS</li></ul><h2 id=critical-issue-swap-thrashing>Critical Issue: Swap Thrashing</h2><h3 id=problem>Problem</h3><p>With the default Ubuntu swappiness setting of <code>60</code>, the system aggressively swaps memory to disk even when there&rsquo;s available RAM. This causes:</p><ul><li><strong>Slow interactive SSH sessions</strong> - Commands take seconds to respond</li><li><strong>High disk I/O</strong> - Constant swap read/write activity</li><li><strong>Degraded container performance</strong> - Services become sluggish</li><li><strong>Poor responsiveness</strong> - Desktop/terminal feels frozen</li></ul><h3 id=why-this-happens>Why This Happens</h3><p><strong>Swappiness</strong> is a Linux kernel parameter that controls how aggressively the system swaps memory pages to disk:</p><ul><li><strong>Value 0-10:</strong> Minimize swapping, use RAM as much as possible</li><li><strong>Value 60 (default):</strong> Balance between RAM and swap usage</li><li><strong>Value 100:</strong> Swap aggressively to keep RAM free</li></ul><p>On desktop/server workloads with 8GB RAM, the default <code>60</code> is <strong>too high</strong> because:</p><ol><li>The kernel preemptively swaps out inactive pages to &ldquo;free up&rdquo; RAM</li><li>When you interact with a swapped process, it causes disk I/O delays</li><li>File-based swap (<code>/swap.img</code>) is slower than physical swap partitions</li><li>Docker containers generate memory pressure that triggers excessive swapping</li></ol><h3 id=current-state-analysis>Current State Analysis</h3><p>Check your current swap usage:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View swap configuration</span>
</span></span><span style=display:flex><span>swapon --show
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Output: NAME      TYPE SIZE USED PRIO</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#         /swap.img file   4G 1.9G   -2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check swappiness value</span>
</span></span><span style=display:flex><span>cat /proc/sys/vm/swappiness
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Output: 60</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View memory and swap usage</span>
</span></span><span style=display:flex><span>free -h
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#               total        used        free      shared  buff/cache   available</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Mem:           7.6Gi       4.0Gi       303Mi       128Mi       3.8Gi       3.7Gi</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Swap:          4.0Gi       1.9Gi       2.1Gi</span>
</span></span></code></pre></div><p><strong>Notice:</strong> 1.9GB of swap used despite having 3.7GB available RAM!</p><h2 id=solution-reduce-swappiness-to-10>Solution: Reduce Swappiness to 10</h2><h3 id=temporary-change-testing>Temporary Change (Testing)</h3><p>Apply immediately without reboot:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Reduce swappiness from 60 to 10</span>
</span></span><span style=display:flex><span>sudo sysctl vm.swappiness<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Verify the change</span>
</span></span><span style=display:flex><span>cat /proc/sys/vm/swappiness
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Output: 10</span>
</span></span></code></pre></div><h3 id=permanent-change-recommended>Permanent Change (Recommended)</h3><p>Make it survive reboots:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add to sysctl configuration</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#39;vm.swappiness=10&#39;</span> <span style=color:#000;font-weight:700>|</span> sudo tee -a /etc/sysctl.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or create a dedicated config file (preferred)</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#39;vm.swappiness=10&#39;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /etc/sysctl.d/99-swappiness.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Apply immediately</span>
</span></span><span style=display:flex><span>sudo sysctl -p /etc/sysctl.d/99-swappiness.conf
</span></span></code></pre></div><h3 id=optional-clear-swap-if-safe>Optional: Clear Swap (If Safe)</h3><p>If your system has free RAM, you can clear the swap cache:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Only do this if you have enough free RAM!</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check free RAM first</span>
</span></span><span style=display:flex><span>free -h
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If you have &gt;4GB free, temporarily disable and re-enable swap</span>
</span></span><span style=display:flex><span>sudo swapoff -a <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> sudo swapon -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Verify swap usage is reduced</span>
</span></span><span style=display:flex><span>free -h
</span></span></code></pre></div><p>⚠️ <strong>Warning:</strong> Do NOT disable swap on a production system during high load!</p><h2 id=expected-results>Expected Results</h2><p>After reducing swappiness to 10:</p><ul><li>✅ <strong>Faster SSH sessions</strong> - Commands respond instantly</li><li>✅ <strong>Lower disk I/O</strong> - Swap only used when RAM is actually full</li><li>✅ <strong>Better container performance</strong> - Services run in RAM, not disk</li><li>✅ <strong>Reduced swap usage</strong> - Should drop to &lt;500MB under normal load</li></ul><h3 id=monitoring-the-impact>Monitoring the Impact</h3><p>Track swap usage over time:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Watch swap usage in real-time</span>
</span></span><span style=display:flex><span>watch -n <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#4e9a06>&#39;free -h | grep -E &#34;Mem|Swap&#34;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check disk I/O (look for low wa% after tuning)</span>
</span></span><span style=display:flex><span>iostat -x <span style=color:#0000cf;font-weight:700>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Monitor with Prometheus/Grafana</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Metrics: node_memory_SwapTotal_bytes, node_memory_SwapFree_bytes</span>
</span></span></code></pre></div><h2 id=additional-performance-optimizations>Additional Performance Optimizations</h2><h3 id=1-container-resource-limits>1. Container Resource Limits</h3><p>Prevent memory exhaustion by limiting top consumers (see docker-compose.yml):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>deploy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>limits</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>768M </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Prevent container from using all RAM</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>reservations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>256M </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># Guaranteed minimum allocation</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>Top memory consumers (pre-limits):</strong></p><ul><li><code>authentik-server</code>: 535MB → Limit to 768MB</li><li><code>radarr</code>: 289MB → Limit to 512MB</li><li><code>sonarr</code>: 194MB → Limit to 384MB</li><li><code>flaresolverr</code>: 174MB → Limit to 256MB</li></ul><h3 id=2-disk-io-optimization>2. Disk I/O Optimization</h3><h4 id=enable-noatime-for-data-drive>Enable noatime for Data Drive</h4><p>Reduce disk writes by not updating access times:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check current mount options</span>
</span></span><span style=display:flex><span>mount <span style=color:#000;font-weight:700>|</span> grep /media/data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add noatime to /etc/fstab</span>
</span></span><span style=display:flex><span>sudo nano /etc/fstab
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Change: /dev/sdb1  /media/data  ext4  defaults  0  2</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># To:     /dev/sdb1  /media/data  ext4  defaults,noatime  0  2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Remount with new options</span>
</span></span><span style=display:flex><span>sudo mount -o remount /media/data
</span></span></code></pre></div><h4 id=docker-log-rotation>Docker Log Rotation</h4><p>Prevent containers from filling disk with logs (add to docker-compose.yml):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>logging</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>driver</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;json-file&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>max-size</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;10m&#34;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>max-file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=3-cpu-governor>3. CPU Governor</h3><p>Ensure CPU runs at full speed under load:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check current governor</span>
</span></span><span style=display:flex><span>cat /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Set to performance mode (optional, increases power usage)</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> performance <span style=color:#000;font-weight:700>|</span> sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or keep ondemand/powersave (default, better for power efficiency)</span>
</span></span></code></pre></div><h3 id=4-swap-file-optimization>4. Swap File Optimization</h3><p>Current swap is a 4GB file. Consider optimizing it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check current swap</span>
</span></span><span style=display:flex><span>sudo swapon --show
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Optional: Increase swap to 8GB (match RAM size)</span>
</span></span><span style=display:flex><span>sudo swapoff /swap.img
</span></span><span style=display:flex><span>sudo dd <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/zero <span style=color:#000>of</span><span style=color:#ce5c00;font-weight:700>=</span>/swap.img <span style=color:#000>bs</span><span style=color:#ce5c00;font-weight:700>=</span>1M <span style=color:#000>count</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>8192</span> <span style=color:#000>status</span><span style=color:#ce5c00;font-weight:700>=</span>progress
</span></span><span style=display:flex><span>sudo chmod <span style=color:#0000cf;font-weight:700>600</span> /swap.img
</span></span><span style=display:flex><span>sudo mkswap /swap.img
</span></span><span style=display:flex><span>sudo swapon /swap.img
</span></span></code></pre></div><p><strong>Note:</strong> With swappiness=10, you may not need more swap.</p><h2 id=monitoring-performance>Monitoring Performance</h2><h3 id=key-metrics-to-track>Key Metrics to Track</h3><ol><li><p><strong>Swap Usage</strong></p><ul><li>Target: &lt;500MB under normal load</li><li>Alert: >2GB indicates memory pressure</li></ul></li><li><p><strong>Memory Pressure</strong></p><ul><li>Target: >1GB free RAM available</li><li>Alert: &lt;500MB free RAM</li></ul></li><li><p><strong>Disk Space</strong></p><ul><li>System: &lt;70% used (currently 67%)</li><li>Data: &lt;90% used (currently 85% ⚠️)</li></ul></li><li><p><strong>Container Restarts</strong></p><ul><li>Target: 0 OOM kills</li><li>Alert: Any container killed due to memory</li></ul></li></ol><h3 id=grafana-dashboard-queries>Grafana Dashboard Queries</h3><p>See the &ldquo;Home Server Overview&rdquo; dashboard for:</p><ul><li>Swap usage trend: <code>node_memory_SwapTotal_bytes - node_memory_SwapFree_bytes</code></li><li>Memory pressure: <code>node_memory_MemAvailable_bytes</code></li><li>Disk usage: <code>node_filesystem_avail_bytes{mountpoint="/"}</code></li></ul><h2 id=troubleshooting>Troubleshooting</h2><h3 id=high-swap-despite-low-swappiness>High Swap Despite Low Swappiness</h3><p>If swap remains high after setting swappiness=10:</p><ol><li>Identify memory hogs: <code>docker stats --no-stream | sort -k7 -h</code></li><li>Check for memory leaks in containers</li><li>Consider adding more RAM or reducing container limits</li><li>Use <code>docker compose restart</code> to reload containers</li></ol><h3 id=oom-killer-triggered>OOM Killer Triggered</h3><p>If containers are killed due to memory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check kernel logs</span>
</span></span><span style=display:flex><span>sudo dmesg <span style=color:#000;font-weight:700>|</span> grep -i <span style=color:#4e9a06>&#34;out of memory&#34;</span>
</span></span><span style=display:flex><span>sudo journalctl -k <span style=color:#000;font-weight:700>|</span> grep -i oom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Identify the victim</span>
</span></span><span style=display:flex><span>docker ps -a <span style=color:#000;font-weight:700>|</span> grep -E <span style=color:#4e9a06>&#34;Exited|Restarted&#34;</span>
</span></span></code></pre></div><p><strong>Solution:</strong> Increase memory limits or reduce concurrent containers.</p><h3 id=slow-performance-after-limits>Slow Performance After Limits</h3><p>If containers perform poorly after adding limits:</p><ol><li>Monitor actual usage: <code>docker stats</code></li><li>Increase limits for legitimate high-memory services</li><li>Check application logs for memory errors</li><li>Consider SSD upgrade if disk I/O is bottleneck</li></ol><h2 id=verification-checklist>Verification Checklist</h2><p>After applying optimizations:</p><ul><li><input disabled type=checkbox> Swappiness set to 10 (<code>cat /proc/sys/vm/swappiness</code>)</li><li><input disabled type=checkbox> Permanent config in <code>/etc/sysctl.d/99-swappiness.conf</code></li><li><input disabled type=checkbox> Swap usage &lt;500MB during normal operation</li><li><input disabled type=checkbox> SSH sessions respond instantly</li><li><input disabled type=checkbox> Free RAM >1GB available</li><li><input disabled type=checkbox> Grafana dashboard shows swap trend</li><li><input disabled type=checkbox> No OOM kills in last 24h (<code>journalctl -k | grep -i oom</code>)</li></ul><h2 id=references>References</h2><ul><li><a href=https://www.kernel.org/doc/Documentation/sysctl/vm.txt>Linux Kernel Documentation: sysctl/vm.txt</a></li><li><a href=https://help.ubuntu.com/community/SwapFaq>Ubuntu Swap FAQ</a></li><li><a href=https://docs.docker.com/config/containers/resource_constraints/>Docker Resource Constraints</a></li><li><a href=https://github.com/prometheus/node_exporter>Prometheus Node Exporter Metrics</a></li></ul><h2 id=need-help>Need Help?</h2><p>If performance issues persist after these optimizations:</p><ol><li>Run <code>scripts/health-check.sh</code> to identify bottlenecks</li><li>Check Grafana dashboards for anomalies</li><li>Review container logs for errors: <code>docker compose logs --tail=100</code></li><li>Consider hardware upgrade (RAM → 16GB for future growth)</li></ol></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Homepage aria-label=Homepage><a target=_blank rel=noopener href=https://homepage.antoineglacet.com aria-label=Homepage><i class="fa fa-home"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2026
<span class=td-footer__authors>Antoine Glacet</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.258190f24d50bde9095e369c0cd7315407f95e1da5f39472b3850b40279a9e08.js integrity="sha256-JYGQ8k1QvekJXjacDNcxVAf5Xh2l85Rys4ULQCeangg=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>