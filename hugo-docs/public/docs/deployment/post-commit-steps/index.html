<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Post-Commit Setup Steps | Home Server Documentation</title><meta name=description content="Manual steps required after applying infrastructure improvements"><meta property="og:url" content="https://docs.antoineglacet.com/docs/deployment/post-commit-steps/"><meta property="og:site_name" content="Home Server Documentation"><meta property="og:title" content="Post-Commit Setup Steps"><meta property="og:description" content="Manual steps required after applying infrastructure improvements"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="Post-Commit Setup Steps"><meta itemprop=description content="Manual steps required after applying infrastructure improvements"><meta itemprop=wordCount content="1066"><meta name=twitter:card content="summary"><meta name=twitter:title content="Post-Commit Setup Steps"><meta name=twitter:description content="Manual steps required after applying infrastructure improvements"><link rel=preload href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css as=style integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><link href=/scss/main.min.6d849f713d8c25ed95d783569522ad6e1604c48142bc1d1ab44b4a15795b3046.css rel=stylesheet integrity="sha256-bYSfcT2MJe2V14NWlSKtbhYExIFCvB0atEtKFXlbMEY=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Home Server Documentation</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class="nav-link active" href=/docs/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=https://homepage.antoineglacet.com target=_blank rel=noopener><span>Homepage</span></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-docsdeploymentpost-commit-steps").addClass("active"),$("#td-section-nav #m-docsdeploymentpost-commit-steps-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-docsdeploymentpost-commit-steps").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-docsdeploymentpost-commit-steps-li").siblings("li").addClass("show"),$("#td-section-nav #m-docsdeploymentpost-commit-steps-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs-li><a href=/docs/ title=Documentation class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Docs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsoperations-li><input type=checkbox id=m-docsoperations-check>
<label for=m-docsoperations-check><a href=/docs/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsoperations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsoperating-li><input type=checkbox id=m-docsoperationsoperating-check>
<label for=m-docsoperationsoperating-check><a href=/docs/operations/operating/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsoperating><span>Operating Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsquick_start-li><input type=checkbox id=m-docsoperationsquick_start-check>
<label for=m-docsoperationsquick_start-check><a href=/docs/operations/quick_start/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsquick_start><span>Quick Start: Fix SSH Lag & LAN Latency</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance-tuning-li><input type=checkbox id=m-docsoperationsperformance-tuning-check>
<label for=m-docsoperationsperformance-tuning-check><a href=/docs/operations/performance-tuning/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance-tuning><span>Performance Tuning Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsoperationsperformance_optimization-li><input type=checkbox id=m-docsoperationsperformance_optimization-check>
<label for=m-docsoperationsperformance_optimization-check><a href=/docs/operations/performance_optimization/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsoperationsperformance_optimization><span>Performance Optimization Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsinfrastructure-li><input type=checkbox id=m-docsinfrastructure-check>
<label for=m-docsinfrastructure-check><a href=/docs/infrastructure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsinfrastructure><span>Infrastructure</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructuretraefik-li><input type=checkbox id=m-docsinfrastructuretraefik-check>
<label for=m-docsinfrastructuretraefik-check><a href=/docs/infrastructure/traefik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructuretraefik><span>Traefik - Reverse Proxy & TLS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsinfrastructureauthentik-li><input type=checkbox id=m-docsinfrastructureauthentik-check>
<label for=m-docsinfrastructureauthentik-check><a href=/docs/infrastructure/authentik/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsinfrastructureauthentik><span>Authentik - SSO & Authentication</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsmonitoring-li><input type=checkbox id=m-docsmonitoring-check>
<label for=m-docsmonitoring-check><a href=/docs/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsmonitoring><span>Monitoring</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringmonitoring-li><input type=checkbox id=m-docsmonitoringmonitoring-check>
<label for=m-docsmonitoringmonitoring-check><a href=/docs/monitoring/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringmonitoring><span>Monitoring & Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmonitoringgrafana-setup-li><input type=checkbox id=m-docsmonitoringgrafana-setup-check>
<label for=m-docsmonitoringgrafana-setup-check><a href=/docs/monitoring/grafana-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsmonitoringgrafana-setup><span>Grafana Setup Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docstroubleshooting-li><input type=checkbox id=m-docstroubleshooting-check>
<label for=m-docstroubleshooting-check><a href=/docs/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docstroubleshooting><span>Troubleshooting</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstroubleshootingtroubleshooting-li><input type=checkbox id=m-docstroubleshootingtroubleshooting-check>
<label for=m-docstroubleshootingtroubleshooting-check><a href=/docs/troubleshooting/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docstroubleshootingtroubleshooting><span>Troubleshooting Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdeployment-li><input type=checkbox id=m-docsdeployment-check>
<label for=m-docsdeployment-check><a href=/docs/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdeployment><span>Deployment</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_checklist-li><input type=checkbox id=m-docsdeploymentdeployment_checklist-check>
<label for=m-docsdeploymentdeployment_checklist-check><a href=/docs/deployment/deployment_checklist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_checklist><span>Deployment Checklist - Infrastructure Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentpost-commit-steps-li><input type=checkbox id=m-docsdeploymentpost-commit-steps-check>
<label for=m-docsdeploymentpost-commit-steps-check><a href=/docs/deployment/post-commit-steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentpost-commit-steps><span>Post-Commit Setup Steps</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentdeployment_notes-li><input type=checkbox id=m-docsdeploymentdeployment_notes-check>
<label for=m-docsdeploymentdeployment_notes-check><a href=/docs/deployment/deployment_notes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentdeployment_notes><span>Deployment Notes - 2026-01-16</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymenthugo-site-setup-li><input type=checkbox id=m-docsdeploymenthugo-site-setup-check>
<label for=m-docsdeploymenthugo-site-setup-check><a href=/docs/deployment/hugo-site-setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymenthugo-site-setup><span>Hugo Documentation Site - Setup Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentalerting_migration-li><input type=checkbox id=m-docsdeploymentalerting_migration-check>
<label for=m-docsdeploymentalerting_migration-check><a href=/docs/deployment/alerting_migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentalerting_migration><span>Alerting Migration to Grafana</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdeploymentreadme-li><input type=checkbox id=m-docsdeploymentreadme-check>
<label for=m-docsdeploymentreadme-check><a href=/docs/deployment/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdeploymentreadme><span></span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsplanning-li><input type=checkbox id=m-docsplanning-check>
<label for=m-docsplanning-check><a href=/docs/planning/ title="Planning & Status" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsplanning><span>Planning</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningimplementation_status-li><input type=checkbox id=m-docsplanningimplementation_status-check>
<label for=m-docsplanningimplementation_status-check><a href=/docs/planning/implementation_status/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningimplementation_status><span>Implementation Status - Home Server Improvements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningnext_steps-li><input type=checkbox id=m-docsplanningnext_steps-check>
<label for=m-docsplanningnext_steps-check><a href=/docs/planning/next_steps/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningnext_steps><span>Next Steps - Alerting Migration Testing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningsecurity_remediation-li><input type=checkbox id=m-docsplanningsecurity_remediation-check>
<label for=m-docsplanningsecurity_remediation-check><a href=/docs/planning/security_remediation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningsecurity_remediation><span>Security Remediation: Discord Webhook Leak</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsplanningreadme-li><input type=checkbox id=m-docsplanningreadme-check>
<label for=m-docsplanningreadme-check><a href=/docs/planning/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsplanningreadme><span></span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#-priority-1-performance-optimization-do-this-first>ğŸš¨ Priority 1: Performance Optimization (DO THIS FIRST!)</a><ul><li><a href=#apply-swap-tuning>Apply Swap Tuning</a></li></ul></li><li><a href=#-priority-2-grafana-datasource-configuration>ğŸ”§ Priority 2: Grafana Datasource Configuration</a></li><li><a href=#-priority-3-grafana-dashboards>ğŸ“Š Priority 3: Grafana Dashboards</a><ul><li><a href=#option-a-import-pre-built-dashboards-recommended>Option A: Import Pre-Built Dashboards (Recommended)</a></li><li><a href=#option-b-create-custom-dashboards>Option B: Create Custom Dashboards</a></li></ul></li><li><a href=#-priority-4-enable-traefik-metrics>ğŸ”” Priority 4: Enable Traefik Metrics</a></li><li><a href=#-priority-5-apply-resource-limits>âš™ï¸ Priority 5: Apply Resource Limits</a></li><li><a href=#-priority-6-verify-security-headers>ğŸ›¡ï¸ Priority 6: Verify Security Headers</a></li><li><a href=#-priority-7-setup-automated-backups>ğŸ“¦ Priority 7: Setup Automated Backups</a><ul><li><a href=#configure-daily-postgresql-backups>Configure Daily PostgreSQL Backups</a></li><li><a href=#verify-duplicati-backups>Verify Duplicati Backups</a></li></ul></li><li><a href=#-priority-8-discord-alerts-configuration->ğŸ” Priority 8: Discord Alerts Configuration âœ…</a></li><li><a href=#-verification-checklist>âœ… Verification Checklist</a></li><li><a href=#-performance-monitoring>ğŸš€ Performance Monitoring</a></li><li><a href=#-additional-documentation>ğŸ“š Additional Documentation</a></li><li><a href=#-troubleshooting>ğŸ†˜ Troubleshooting</a><ul><li><a href=#grafana-datasources-not-appearing>Grafana Datasources Not Appearing</a></li><li><a href=#prometheus-not-scraping-targets>Prometheus Not Scraping Targets</a></li><li><a href=#resource-limits-causing-oom-kills>Resource Limits Causing OOM Kills</a></li><li><a href=#high-swap-despite-swappiness10>High Swap Despite swappiness=10</a></li></ul></li><li><a href=#-next-steps>ğŸ¯ Next Steps</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/deployment/>Deployment</a></li><li class="breadcrumb-item active" aria-current=page>Post-Commit Setup Steps</li></ol></nav><div class=td-content><h1>Post-Commit Setup Steps</h1><div class=lead>Manual steps required after applying infrastructure improvements</div><header class=article-meta></header><p>This document outlines manual steps required after applying the infrastructure improvements commit.</p><h2 id=-priority-1-performance-optimization-do-this-first>ğŸš¨ Priority 1: Performance Optimization (DO THIS FIRST!)</h2><h3 id=apply-swap-tuning>Apply Swap Tuning</h3><p>This will immediately improve your interactive session responsiveness:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Apply swappiness change immediately</span>
</span></span><span style=display:flex><span>sudo sysctl vm.swappiness<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Make it permanent</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#39;vm.swappiness=10&#39;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /etc/sysctl.d/99-swappiness.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Verify</span>
</span></span><span style=display:flex><span>cat /proc/sys/vm/swappiness
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should output: 10</span>
</span></span></code></pre></div><p><strong>Expected result:</strong> SSH sessions respond instantly, less disk thrashing</p><hr><h2 id=-priority-2-grafana-datasource-configuration>ğŸ”§ Priority 2: Grafana Datasource Configuration</h2><p>Grafana container runs as UID 1000, so datasource provisioning requires sudo:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create datasources configuration</span>
</span></span><span style=display:flex><span>sudo mkdir -p config/grafana/provisioning/datasources
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo tee config/grafana/provisioning/datasources/datasources.yml &gt; /dev/null <span style=color:#4e9a06>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>datasources:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - name: Prometheus
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: prometheus
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    access: proxy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    url: http://prometheus:9090
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    isDefault: true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    editable: false
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    jsonData:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      timeInterval: 15s
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      httpMethod: POST
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - name: Loki
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: loki
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    access: proxy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    url: http://loki:3100
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    editable: false
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    jsonData:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxLines: 1000
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Fix ownership</span>
</span></span><span style=display:flex><span>sudo chown -R 1000:1000 config/grafana/provisioning
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Restart Grafana to load datasources</span>
</span></span><span style=display:flex><span>docker compose restart grafana
</span></span></code></pre></div><p>Verify:</p><ul><li>Navigate to Grafana: http://localhost:3000</li><li>Go to Configuration â†’ Data Sources</li><li>Both Prometheus and Loki should show green status</li></ul><hr><h2 id=-priority-3-grafana-dashboards>ğŸ“Š Priority 3: Grafana Dashboards</h2><h3 id=option-a-import-pre-built-dashboards-recommended>Option A: Import Pre-Built Dashboards (Recommended)</h3><p>Since the dashboard JSON files are large, use community dashboards as a starting point:</p><p><strong>Home Server Overview Dashboard:</strong></p><ol><li>Go to Grafana â†’ Dashboards â†’ Import</li><li>Use Dashboard ID: <code>1860</code> (Node Exporter Full)</li><li>Select Prometheus datasource</li><li>Click Import</li><li>Customize as needed</li></ol><p><strong>cAdvisor/Docker Dashboard:</strong></p><ol><li>Go to Dashboards â†’ Import</li><li>Use Dashboard ID: <code>193</code> (Docker Monitoring)</li><li>Select Prometheus datasource</li><li>Click Import</li></ol><p><strong>Loki Logs Dashboard:</strong></p><ol><li>Go to Dashboards â†’ Import</li><li>Use Dashboard ID: <code>13639</code> (Loki Dashboard)</li><li>Select Loki datasource</li><li>Click Import</li></ol><h3 id=option-b-create-custom-dashboards>Option B: Create Custom Dashboards</h3><p>Follow the guide in <code>docs/grafana-setup.md</code> for creating custom dashboards with:</p><ul><li>Swap usage monitoring</li><li>Disk space trends</li><li>Container resource usage</li><li>Media pipeline stats</li></ul><hr><h2 id=-priority-4-enable-traefik-metrics>ğŸ”” Priority 4: Enable Traefik Metrics</h2><p>Traefik needs metrics endpoint enabled. Add this to docker-compose.yml in the <code>traefik</code> service command section:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>traefik</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>command</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#8f5902;font-style:italic># ... existing commands ...</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span>- --<span style=color:#000>metrics.prometheus=true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span>- --<span style=color:#000>metrics.prometheus.addEntryPointsLabels=true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span>- --<span style=color:#000>metrics.prometheus.addServicesLabels=true</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span>- --<span style=color:#000>entryPoints.metrics.address=:8082</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>Then restart Traefik:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose up -d traefik
</span></span></code></pre></div><p>Verify metrics are available:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://localhost:8082/metrics <span style=color:#000;font-weight:700>|</span> head -20
</span></span></code></pre></div><hr><h2 id=-priority-5-apply-resource-limits>âš™ï¸ Priority 5: Apply Resource Limits</h2><p>The docker-compose.yml now includes resource limits for top memory consumers. To apply them:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Restart services with new limits</span>
</span></span><span style=display:flex><span>docker compose up -d authentik-server radarr sonarr flaresolverr bazarr
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Monitor to ensure services start correctly</span>
</span></span><span style=display:flex><span>docker compose logs authentik-server --tail<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>50</span>
</span></span><span style=display:flex><span>docker stats
</span></span></code></pre></div><p><strong>Services with limits:</strong></p><ul><li><code>authentik-server</code>: 768MB limit</li><li><code>radarr</code>: 512MB limit</li><li><code>sonarr</code>: 384MB limit</li><li><code>flaresolverr</code>: 256MB limit</li><li><code>bazarr</code>: 256MB limit</li></ul><p>If any service fails to start, check logs and increase the limit if needed.</p><hr><h2 id=-priority-6-verify-security-headers>ğŸ›¡ï¸ Priority 6: Verify Security Headers</h2><p>After restarting Traefik, verify security headers are being set:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Test from external domain</span>
</span></span><span style=display:flex><span>curl -I https://your-domain.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should see headers like:</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># X-Frame-Options: DENY</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># X-Content-Type-Options: nosniff</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Strict-Transport-Security: max-age=31536000</span>
</span></span></code></pre></div><hr><h2 id=-priority-7-setup-automated-backups>ğŸ“¦ Priority 7: Setup Automated Backups</h2><h3 id=configure-daily-postgresql-backups>Configure Daily PostgreSQL Backups</h3><p>Add to crontab:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Edit crontab</span>
</span></span><span style=display:flex><span>crontab -e
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Add daily backup at 2 AM</span>
</span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>0</span> <span style=color:#0000cf;font-weight:700>2</span> * * * /home/antoine/home-server/scripts/backup-postgres.sh &gt;&gt; /var/log/postgres-backup.log 2&gt;<span style=color:#000;font-weight:700>&amp;</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span></code></pre></div><p>Test the backup script manually first:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> /home/antoine/home-server
</span></span><span style=display:flex><span>./scripts/backup-postgres.sh
</span></span></code></pre></div><h3 id=verify-duplicati-backups>Verify Duplicati Backups</h3><p>Run the validation script:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./scripts/validate-backups.sh
</span></span></code></pre></div><p>Fix any issues reported.</p><hr><h2 id=-priority-8-discord-alerts-configuration->ğŸ” Priority 8: Discord Alerts Configuration âœ…</h2><p><strong>Status:</strong> Already configured! Discord alerts are now working via alertmanager-discord bridge.</p><p>The setup includes:</p><ul><li>âœ… Alertmanager service running</li><li>âœ… alertmanager-discord bridge deployed</li><li>âœ… Configuration using <code>DISCORD_WEBHOOK_URL</code> from .env</li><li>âœ… 20+ alert rules active</li></ul><p><strong>Verify Discord alerts are working:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Send test alert (v2 API)</span>
</span></span><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt; &#39;EOF&#39; | curl -X POST -H &#34;Content-Type: application/json&#34; -d @- http://localhost:9093/api/v2/alerts
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>[
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    &#34;labels&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      &#34;alertname&#34;: &#34;TestAlert&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      &#34;severity&#34;: &#34;info&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      &#34;instance&#34;: &#34;home-server&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    },
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    &#34;annotations&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      &#34;summary&#34;: &#34;Test Alert from Home Server&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      &#34;description&#34;: &#34;If you see this in Discord, alerts are working!&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    }
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  }
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>]
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Alertmanager logs</span>
</span></span><span style=display:flex><span>docker compose logs alertmanager-discord --tail<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>10</span>
</span></span></code></pre></div><p><strong>Architecture:</strong></p><pre tabindex=0><code>Prometheus â†’ Alertmanager â†’ alertmanager-discord bridge â†’ Discord
            (port 9093)         (port 9094)
</code></pre><p><strong>View active alerts:</strong> http://localhost:9093 or <a href=https://alertmanager.your-domain.com>https://alertmanager.your-domain.com</a></p><hr><h2 id=-verification-checklist>âœ… Verification Checklist</h2><p>After completing all steps, verify everything is working:</p><ul><li><input disabled type=checkbox> Swappiness is set to 10: <code>cat /proc/sys/vm/swappiness</code></li><li><input disabled type=checkbox> Swap usage is decreasing: <code>free -h</code> (check over time)</li><li><input disabled type=checkbox> Grafana datasources are connected (green status)</li><li><input disabled type=checkbox> Dashboards are showing data</li><li><input disabled type=checkbox> Traefik metrics are being scraped by Prometheus</li><li><input disabled type=checkbox> Prometheus is collecting metrics: http://localhost:9090/targets (all UP)</li><li><input disabled type=checkbox> Resource limits are applied: <code>docker inspect authentik-server | grep -A5 Memory</code></li><li><input disabled type=checkbox> Security headers are present: <code>curl -I https://your-domain.com</code></li><li><input disabled type=checkbox> Backup scripts are working: <code>./scripts/validate-backups.sh</code></li><li><input disabled type=checkbox> PostgreSQL backups are being created</li><li><input disabled type=checkbox> Alert manager is receiving alerts</li><li><input disabled type=checkbox> All containers are running: <code>docker compose ps</code></li><li><input disabled type=checkbox> No errors in logs: <code>docker compose logs --tail=100</code></li></ul><hr><h2 id=-performance-monitoring>ğŸš€ Performance Monitoring</h2><p>After 24 hours, check the improvements:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Run health check</span>
</span></span><span style=display:flex><span>./scripts/health-check.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check swap usage trend</span>
</span></span><span style=display:flex><span>free -h
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check disk I/O wait (should be low now)</span>
</span></span><span style=display:flex><span>iostat -x <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#0000cf;font-weight:700>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View Grafana dashboards for historical trends</span>
</span></span></code></pre></div><p><strong>Expected improvements:</strong></p><ul><li>âœ… Swap usage &lt;500MB (down from 1.9GB)</li><li>âœ… SSH sessions respond instantly</li><li>âœ… Lower disk I/O wait times</li><li>âœ… More consistent container performance</li><li>âœ… Visibility into all system metrics</li></ul><hr><h2 id=-additional-documentation>ğŸ“š Additional Documentation</h2><ul><li><code>docs/performance-tuning.md</code> - Detailed swap and performance optimization guide</li><li><code>docs/grafana-setup.md</code> - Grafana configuration and dashboard creation</li><li><code>README.md</code> - Updated with OptiPlex hardware specs</li></ul><hr><h2 id=-troubleshooting>ğŸ†˜ Troubleshooting</h2><h3 id=grafana-datasources-not-appearing>Grafana Datasources Not Appearing</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Grafana logs</span>
</span></span><span style=display:flex><span>docker compose logs grafana <span style=color:#000;font-weight:700>|</span> grep -i datasource
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Verify file ownership</span>
</span></span><span style=display:flex><span>ls -la config/grafana/provisioning/datasources/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Should be: drwxr-xr-x 1000 1000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Fix if needed</span>
</span></span><span style=display:flex><span>sudo chown -R 1000:1000 config/grafana/provisioning/
</span></span><span style=display:flex><span>docker compose restart grafana
</span></span></code></pre></div><h3 id=prometheus-not-scraping-targets>Prometheus Not Scraping Targets</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Prometheus config syntax</span>
</span></span><span style=display:flex><span>docker compose <span style=color:#204a87>exec</span> prometheus promtool check config /etc/prometheus/prometheus.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View scrape targets</span>
</span></span><span style=display:flex><span>curl http://localhost:9090/targets
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Traefik metrics endpoint</span>
</span></span><span style=display:flex><span>curl http://localhost:8082/metrics
</span></span></code></pre></div><h3 id=resource-limits-causing-oom-kills>Resource Limits Causing OOM Kills</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check for OOM kills</span>
</span></span><span style=display:flex><span>docker compose logs <span style=color:#000;font-weight:700>|</span> grep -i <span style=color:#4e9a06>&#34;killed\|oom&#34;</span>
</span></span><span style=display:flex><span>sudo dmesg <span style=color:#000;font-weight:700>|</span> grep -i oom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If services are being killed, increase limits in docker-compose.yml</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Then restart: docker compose up -d &lt;service-name&gt;</span>
</span></span></code></pre></div><h3 id=high-swap-despite-swappiness10>High Swap Despite swappiness=10</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Clear swap if safe (ensure &gt;4GB free RAM first!)</span>
</span></span><span style=display:flex><span>free -h
</span></span><span style=display:flex><span>sudo swapoff -a <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> sudo swapon -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Monitor swap usage</span>
</span></span><span style=display:flex><span>watch -n <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#4e9a06>&#39;free -h&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check for memory leaks in containers</span>
</span></span><span style=display:flex><span>docker stats --no-stream <span style=color:#000;font-weight:700>|</span> sort -k7 -h -r
</span></span></code></pre></div><hr><h2 id=-next-steps>ğŸ¯ Next Steps</h2><p>Once everything is stable:</p><ol><li><strong>Create custom Grafana alerts</strong> for your specific thresholds</li><li><strong>Set up Vaultwarden</strong> for secret management (separate commit)</li><li><strong>Configure Authentik OAuth</strong> for Grafana SSO</li><li><strong>Add CI/CD validation</strong> (GitHub Actions, pre-commit hooks)</li><li><strong>Document your specific alert thresholds</strong> based on observed metrics</li><li><strong>Consider upgrading to 16GB RAM</strong> for future growth</li></ol><hr><p>Need help? Check:</p><ul><li>Container logs: <code>docker compose logs &lt;service> --tail=100</code></li><li>System health: <code>./scripts/health-check.sh</code></li><li>Backup status: <code>./scripts/validate-backups.sh</code></li><li>Prometheus: http://localhost:9090</li><li>Grafana: http://localhost:3000</li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Homepage aria-label=Homepage><a target=_blank rel=noopener href=https://homepage.antoineglacet.com aria-label=Homepage><i class="fa fa-home"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2026
<span class=td-footer__authors>Antoine Glacet</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.258190f24d50bde9095e369c0cd7315407f95e1da5f39472b3850b40279a9e08.js integrity="sha256-JYGQ8k1QvekJXjacDNcxVAf5Xh2l85Rys4ULQCeangg=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>